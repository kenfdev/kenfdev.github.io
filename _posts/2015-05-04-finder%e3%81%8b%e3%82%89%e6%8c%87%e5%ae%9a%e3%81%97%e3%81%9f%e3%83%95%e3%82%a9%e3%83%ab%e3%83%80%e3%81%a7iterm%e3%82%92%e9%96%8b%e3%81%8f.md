---
title: Finderから指定したフォルダでiTermを開く
author: kenev
layout: post
permalink: /2015/05/04/finder%e3%81%8b%e3%82%89%e6%8c%87%e5%ae%9a%e3%81%97%e3%81%9f%e3%83%95%e3%82%a9%e3%83%ab%e3%83%80%e3%81%a7iterm%e3%82%92%e9%96%8b%e3%81%8f/
s4_url2s:
  - 
s4_image2s:
  - 
s4_ctitle:
  - 
s4_cdes:
  - 
categories:
  - Automator
tags:
  - automator
  - iterm
  - javascript
  - service
---
Finderで開いているフォルダでターミナル（私の場合iTerm）を開きたくなることはよくあると思います。Windowsであれば`shift + 右クリック`で`コマンドウィンドウをここで開く`というメニューが表示されるのですが、OSXでは標準でそのような機能がありません。

# Automator

OSXにはAutomatorというアプリがあり、いろんなタスクの自動化ができます。中でもYosemiteから`AppleScript`だけでなく`JavaScript`が実行できるようになったのが非常におもしろい！しかしながらドキュメントが少なすぎてちょっとつらい。手探りでiTermを開くスクリプトを作りました。

## Script Editor

まず、`iTerm`にどのようなAPIが用意されているのか`Script Editor`で調べる必要があります。「ファイル＞用語説明を開く」で`iTerm.app`を選択することでAPIを調べることができます。今回は`make`, `launch`, `write`を使うことで要件が満たせそうです。

### make

    make method : Make a new object.
      make
        new: type : The class of the new object.
        [at: location specifier] : The location at which to insert the object.
        [withData: any] : The initial data for the object.
        [withProperties: record] : The initial values for properties of the object.
        → specifier
    

### launch

    launch method : Launches a default or saved session
      launch specifier : the object for the command
        session: Text : Name of session to be launched
        → Session
    

### write

    write method : Writes text or file contents into a session
      write specifier : the object for the command
        [contentsOfFile: Text] : File to be written
        [text: Text] : Text to be written
    

## 実践

[<img src="http://kenev.net/wp-content/uploads/2015/05/ee11a998ab3eefd5d0d9cb7d897a7261-1024x780.png" alt="スクリーンショット 2015-05-04 15.45.20" width="660" height="503" class="alignnone size-large wp-image-348" />][1]

実際に作ってみましょう！新規Automatorを作成して上のキャプチャみたいに`サービス`を選択します。

[<img src="http://kenev.net/wp-content/uploads/2015/05/9e98000bafb0f809e1de2f0ff4ab7362-1024x780.png" alt="スクリーンショット 2015-05-04 15.24.57" width="660" height="503" class="alignnone size-large wp-image-349" />][2]

  1. `JavaScriptを実行`を選択
  2. フォルダに対して実行したいので`フォルダ`を選択
  3. 実際に実行するスクリプトを書きます

<pre><code class="js">function run(input, parameters) {

    filePath = Path(input);
    termApp = Application('iTerm');
    term = termApp.make({new: 'terminal'});
    s = term.launch({session:'default'});
    s.write({text: 'cd "' + filePath + '"'});

    return;
}
</code></pre>

先に調べたドキュメントの通りにAPIを使ってみて`open iTerm here`として保存します。`サービス`として登録されていることがわかります。

[<img src="http://kenev.net/wp-content/uploads/2015/05/20c82d6f3ce7e2f935e23a96df58d1c9.png" alt="スクリーンショット 2015-05-04 15.25.30" width="942" height="754" class="alignnone size-full wp-image-350" />][3]

これで一応開いたフォルダの場所でiTermが開かれるようになります。ただ、初回起動時はデフォルトのセッションが開かれてしまうのがちょっと気に入らない。。。

 [1]: http://kenev.net/wp-content/uploads/2015/05/ee11a998ab3eefd5d0d9cb7d897a7261.png
 [2]: http://kenev.net/wp-content/uploads/2015/05/9e98000bafb0f809e1de2f0ff4ab7362.png
 [3]: http://kenev.net/wp-content/uploads/2015/05/20c82d6f3ce7e2f935e23a96df58d1c9.png