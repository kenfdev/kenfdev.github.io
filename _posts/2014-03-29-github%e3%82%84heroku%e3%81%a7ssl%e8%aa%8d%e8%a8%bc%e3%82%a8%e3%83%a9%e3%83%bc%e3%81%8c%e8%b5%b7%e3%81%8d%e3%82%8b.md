---
title: GithubやHerokuでSSL認証エラーが起きる
author: kenev
layout: post
permalink: /2014/03/29/github%e3%82%84heroku%e3%81%a7ssl%e8%aa%8d%e8%a8%bc%e3%82%a8%e3%83%a9%e3%83%bc%e3%81%8c%e8%b5%b7%e3%81%8d%e3%82%8b/
categories:
  - Mac
tags:
  - digicert
  - keychain
  - ssl-error
---
この問題には割と悩まされました。  
GithubやHerokuのサイトを訪れてもCSSがまるで反映されておらず、レイアウトがむちゃくちゃな背景白の画面になってしまっていたのです。option + shift + i でサイトの分析をしてみるとCSSのダウンロードを行おうとするところでSSLの認証エラーを起こしているようでした。

[<img class="alignnone size-medium wp-image-93" alt="スクリーンショット 2014-03-29 20.50.12" src="http://kenev.net/wp-content/uploads/2014/03/29d12d0483fe103bab53060adb9cd2d0-300x159.png" width="300" height="159" />][1]  
エラーのコメントを見ると

<span style="line-height: 1.5em;">「サーバー証明書　機密情報漏えいの恐れ」</span>

みたいな恐ろしいことが書いてあって、なにゆえGithubやHerokuでこんな問題が発生するの？と疑問を持ちながら調べてみても同じような現象に陥っている人が全然いなくて原因究明が困難でした。

この現象が起きる前の自分の行動を思い返してみて「もしかしたら」と思った行動がありました。というかこれしかありえないんですが、先日Githubから「git clone」しようとしてもSSL認証エラーに衝突していてトラブルシュートしようとしたのです。参考にしたのは下の記事。

[Mac OS X 10.9.2でGitHubにアクセスするとサーバー証明書のエラーが発生する場合の解決策][2]

さら〜っと読んで特に何も考えずに「DigiCert High Assurance EV Root CA」を削除したのですが、これを「ログイン」だけでなく「システムルート」からも削除したのが問題でした。知ってる人からしてみれば「おいおい、ルート証明書なんて消すなよ」って思うのでしょうが、私は全然知識を持っていなかったし完全に軽率な行動をとってしまっていたのでこんな結果になっちゃいました。

さて、だいたいの原因はわかったところで「じゃあどうやったらDigiCert High Assurance EV Root CAを復活できるのか？」という疑問が浮上します。これも調べてみたんですけどぱっと答えがすぐ出てこなかったんですよね。（調べ方が悪いのか）この時見つかった方法としてはstackoverflowで探してみても「キーチェーンのバックアップがあればそこから復元しろ」というものでした。幸い私はTimeMachineにバックアップを残していましたし、特に重要なパスワードとかはキーチェーンに保存していないので下記ファイルを復元しました。

/System/Library/Keychains/SystemRootCertificates.keychain

見事に「DigiCert High Assurance EV Root CA」が復活して、GithubもHerokuも通常通り表示されるようになりました。ひとまず安心安心！

&nbsp;

そして、[この記事][3]をみて後日わかったことですが簡単に証明書は再度追加できました。まずは下記サイトにて「DigiCert High Assurance EV Root CA」のDownloadをクリックして証明書をダウンロード。  
[DigiCert Trusted Root Authority Certificates][4]

「DigiCertHighAssuranceEVRootCA.crt」なるファイルがダウンロードされるのでMacの「キーチェーンアクセス」を開いて「+」ボタンを押下して証明書を追加すれば完了。後はブラウザを再起動すれば証明書がしっかり反映されているのです。

 [1]: http://kenev.net/wp-content/uploads/2014/03/29d12d0483fe103bab53060adb9cd2d0.png
 [2]: http://orangain.hatenablog.com/entry/2014/03/01/mavericks-ssl-certificate
 [3]: http://d.hatena.ne.jp/tetsuyai/20110924/1316877887
 [4]: https://www.digicert.com/digicert-root-certificates.htm